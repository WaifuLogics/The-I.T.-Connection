function RetrieveAllFriends(){let options;fetch("{{ path_for('chat-retrieve') }}",{headers:{"content-type":"application/x-www-form-urlencoded; charset=UTF-8"},credentials:"same-origin"}).then(response=>response.json()).then(async json=>{GetId("list-chat_friends").innerHTML="";for(let friend of json.response)"{{ accountId }}"!=friend.account_id?GetId("list-chat_friends").innerHTML+=`\n                    <button onclick="AddFriendToChatRoom(this.value)" data-userId="${await friend.account_id}" class="btn blue waves-effect waves-light friend-btn" value="${await ReturnUserName(friend.account_id)}">Add ${await ReturnUserName(friend.account_id)}</button>\n                `:"{{ accountId }}"!=friend.account_friended&&(GetId("list-chat_friends").innerHTML+=`\n                    <button onclick="AddFriendToChatRoom(this.value);" data-userId="${await friend.account_friended}" class="btn blue waves-effect waves-light friend-btn" value="${await ReturnUserName(friend.account_friended)}">Add ${await ReturnUserName(friend.account_friended)}</button>\n                `)})}function AddFriendToChatRoom(friend){let elems=document.getElementsByClassName("friend-btn");for(let i=0;i<elems.length;i+=1){let cName=elems[i].className;elems[i].value!=friend||cName.includes("addFriend")?elems[i].value==friend&&cName.includes("addFriend")&&(M.toast({html:"Removed "+friend+" from chat room",displayLength:"1500",inDuration:"600",outDuration:"600"}),elems[i].classList.remove("addFriend"),elems[i].innerHTML="Add "+friend):(M.toast({html:"added "+friend+" to chat room",displayLength:"1500",inDuration:"600",outDuration:"600"}),elems[i].classList.add("addFriend"),elems[i].innerHTML="<i class='material-icons'>done</i> "+friend)}}function CreateChatRoom(){let users=document.getElementsByClassName("addFriend"),json=[];for(let user of users)json[json.length]=user.getAttribute("data-userId");if(!(GetId("chat_room_name").value.length>0&&GetId("chat_room_name").value.length<=32))return void M.toast({html:"Please fill in a valid room name.",displayLength:"1500",inDuration:"600",outDuration:"600"});if(json.length<1)return void M.toast({html:"Please add one more friend to the chat room",displayLength:"1500",inDuration:"600",outDuration:"600"});let jsonText={users:json};console.log(jsonText);let bodyInfo,options={method:"post",headers:{"content-type":"application/x-www-form-urlencoded; charset=UTF-8"},body:"roomName="+GetId("chat_room_name").value+"&users="+window.btoa(JSON.stringify(jsonText))};M.toast({html:"Creating Chat Room",displayLength:"1500",inDuration:"600",outDuration:"600"}),fetch("{{ path_for('chat-create') }}",options).then(response=>response.json()).then(json=>{"success"==json.response&&(M.toast({html:"Chat Room Created",displayLength:"1500",inDuration:"600",outDuration:"600"}),ClearCreateChatRoomForm())})}function ClearCreateChatRoomForm(){GetId("chat_room_name").value="";let users=document.getElementsByClassName("friend-btn");for(let elem of users)elem.classList.contains("addFriend")&&!elem.classList.contains("hidden")&&(console.log(elem.value),elem.innerHTML="Add "+elem.value,elem.classList.remove("addFriend"))}